<Screen_mange>:
    id: main_screen_manager
    Login:
        name: "login"
    Main:
        name: "main"

   
<Login@MDScreen>:
    MDFloatLayout:
        FitImage:
            source: "imag/login_img.png"
            size_hint: 1, 1
            fit_mode:"contain"
            keep_ratio: False

        MDCard:
            size_hint: 0.75, None
            height: self.minimum_height
            pos_hint: {"center_x": 0.5, "center_y": 0.5}
            orientation: "vertical"
            elevation: 8
            md_bg_color: .11,.72,.78,.2
            padding: "24dp"
            spacing: "18dp"

            MDLabel:
                text: "Login Portal"
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 0.9
                halign: "center"
                font_style: "H5"
                bold: True

            MDTextField:
                id: user_name
                hint_text: "Enter Your Username"
                helper_text: "Required"
                helper_text_mode: "on_focus"
                mode: "line"
                font_size:"20sp"
                icon_left: "account"
                size_hint_x: 0.9     
                pos_hint: {"center_x": 0.5}
                radius: [15, 15, 15, 15]

                # TEXT COLOR (FIX)
                text_color_normal: .9,.96,1,1          # Default input text color
                text_color_focus: .9,.96,1,1           # Text while typing âœ”

                # HINT & UNDERLINE COLORS
                hint_text_color_focus: 0.3,0.7,1,1
                line_color_focus: 0.3,0.7,1,1

                # HELPER COLOR
                helper_text_color_focus: 0.3,0.7,1,1

                # BACKGROUND FILL (optional glow feel)
                fill_color: .1,.3,.45,.5


            MDTextField:
                id: password
                hint_text: "Enter Your Password"
                helper_text: "Required"
                helper_text_mode: "on_focus"
                mode: "line"
                fill_color: 1, 1, 1, 0.15
                icon_left: "lock"
                password: True
                size_hint_x: 0.9
                pos_hint: {"center_x": 0.5}
                radius: [15, 15, 15, 15]
                text_color: 0, 0, 0, 1
                line_color_focus: 0.3, 0.6, 1, 1
                helper_text_color_focus: 0.3, 0.6, 1, 1
                hint_text_color: 0.3, 0.6, 1, 1

            MDRaisedButton:
                text: "Login"
                size_hint: None, None
                size: "140dp", "44dp"
                pos_hint: {"center_x": 0.5}
                md_bg_color: 0.2, 0.6, 0.86, 1
                text_color: 1, 1, 1, 1
                on_release: app.root.login_re(user_name, password)
<Home>:
    name:"home"
    id:home_screen
    # Graph: 
    Navigation:
        
    Nav_graph_manager:
        pos_hint: {"x":.35}
        id: nav_graph_manager 
    MDTopAppBar:
        pos_hint: {"top": 1}
        title: "Home"        
        left_action_items: [["menu", lambda x: root.ids.nav_drawer.set_state("toggle")]]



<Main@MDScreen>:        
    MDNavigationLayout:
        id:navigation_lay
        ScreenManager:
            id: main_screen_manager_home
            Home:
                name:"home"
                id:home_screen
                MDTopAppBar:
                    pos_hint: {"top": 1}
                    title: "Home"
                    left_action_items: [["menu", lambda x: nav_drawer.set_state("toggle")]]
                       

            MDScreen:
                name: "add_student"

                MDTopAppBar:
                    pos_hint: {"top": 1}
                    title: "Add Student"
                    left_action_items: [["menu", lambda x: nav_drawer.set_state("toggle")]]

                FloatLayout:
                    MDCard:
                        orientation: "vertical"
                        size_hint: 0.4, None
                        height: self.minimum_height
                        padding: dp(20)
                        spacing: dp(20)
                        pos_hint: {"x": 0.1, "y": 0.3}
                        elevation: 12
                        radius: [20, 20, 20, 20]

                        MDLabel:
                            text: "Student Registration"
                            font_style: "H5"
                            halign: "center"
                            theme_text_color: "Custom"
                            text_color: 0.2, 0.4, 0.9, 1

                        MDTextField:
                            id: name_field
                            hint_text: "Name"
                            helper_text: "Required"
                            helper_text_mode: "on_focus"
                            icon_left: "account"
                            mode: "round"
                            size_hint_x: 1
                            line_color_focus: 0.3, 0.6, 1, 1

                        MDTextField:
                            id: roll_field
                            hint_text: "Roll Number"
                            helper_text: "Required"
                            helper_text_mode: "on_focus"
                            icon_left: "format-list-numbered"
                            mode: "round"
                            size_hint_x: 1
                            line_color_focus: 0.3, 0.6, 1, 1

                        MDTextField:
                            id: mobile_field
                            hint_text: "Parent's Mobile Number"
                            helper_text: "Required"
                            helper_text_mode: "on_focus"
                            icon_left: "cellphone"
                            mode: "round"
                            size_hint_x: 1
                            line_color_focus: 0.3, 0.6, 1, 1

                        MDRaisedButton:
                            text: "Add Photo"
                            icon: "check"
                            pos_hint: {"center_x": 0.5}
                            md_bg_color: 0.3, 0.6, 1, 1
                            text_color: 1, 1, 1, 1
                            elevation: 8
                            
                            on_release: webcam_view.video_()  #  Start camera

                        MDLabel:
                            id: feedback_label
                            text: ""
                            halign: "center"
                            theme_text_color: "Custom"
                            text_color: 1, 0, 0, 1

                    MDCard:
                        size_hint: (.4, .5)
                        pos_hint: {"x": 0.55, "y": 0.3}
                        RelativeLayout:
        
                            Imag1:
                                id: webcam_view
                                size_hint: (1, 1)
                                fit_mode:"contain"
                                keep_ratio: True

                                                    
                    MDRaisedButton:
                        text:"Save"
                        pos_hint: {"center_x": 0.5, "y": 0.15}
                        on_press:
                            webcam_view.save(name_field,roll_field,mobile_field)
                            root.ids.name_field.text = ""
                            root.ids.roll_field.text = ""
                            root.ids.mobile_field.text = ""
                                            
            MDScreen:
                name: "start_attandance"
                id:start_attandance

                MDTopAppBar:
                    pos_hint: {"top": 1}
                    title: "Start Attendance"
                    left_action_items: [["menu", lambda x: nav_drawer.set_state("toggle")]]
                MDFloatLayout:
                    MDCard:
                        size_hint: (.4, .5)
                        pos_hint: {"x": 0.05, "y": 0.3}
                        Start_attandance: 
                            id:live_screen
                    MDRaisedButton:
                        text:"Start"
                        pos_hint: {"center_x":.4,"center_y":.2}
                        on_press: live_screen.video_() 
                    MDRaisedButton:
                        text:"Stop"
                        pos_hint: {"center_x":.6,"center_y":.2} 
                        on_press:live_screen.re_camara()
            Setting:
                name:"setting"
                dynamic_input_box: dynamic_input_box
                float_1: float_1
                        
                MDTopAppBar:
                    pos_hint: {"top": 1}
                    title: "Settings"
                    left_action_items: [["menu", lambda x: nav_drawer.set_state("toggle")]]
                MDFloatLayout:
                    id: setting_lay
                    ScrollView:
                        size_hint: (.5, .8)
                        BoxLayout:    
                            pos_hint: ("center_x", 0.5)
                            orientation: 'vertical'
                            size_hint_y: None
                            height: self.minimum_height
                            GridLayout:
                                cols: 1
                                size_hint_y: None
                                height: self.minimum_height
                                id:dynamic_input_box
                                # orientation: 'vertical'
                            
                                pos_hint: {"x": .1, "top": .2}
                    FloatLayout:
                        size_hint: (.6,1)
                        pos_hint: {"x": .5, "center_y": 0.8}
                        id:float_1
                        MDLabel:
                            pos_hint: {"x": 0.25, "center_y": 0.51}
                            text:"Theme :"

                        MDSwitch:
                            pos_hint: {"x": 0.45, "center_y": 0.5}
                            id: switch_theme
                            track_color_active: (0.2, 0.2, 0.2, 1)
                            track_color_disabled: (0.5, 0.5, 0.5, 1)
                            on_active: 
                                app.theme_change(switch_theme.active)                                   
                            on_kv_post: 
                                app.get_theme(self)
                
                        MDLabel:
                            pos_hint: {"x": 0.25, "center_y": 0.41}
                            text:"Auto Attendace :"

                        MDSwitch:
                            # active: 
                            pos_hint: {"x": 0.45, "center_y": 0.40}
                            id: switch_auto
                            # pos_hint: {"center_x": 0.5, "center_y": 0.5}
                            
                            track_color_active: (0.2, 0.2, 0.2, 1)
                            track_color_disabled: (0.5, 0.5, 0.5, 1)
                            on_active:
                                app.auto_on_of(switch_auto.active)  # Call the auto_on_of method in MyApp
                                # root.ids.lacture.disabled = not (switch_auto.active)
                                # root.ids.lacture_time.disabled = not (switch_auto.active)
                                # root.ids.break_time.disabled = not(switch_auto.active)
                        MDTextField:
                            disabled: not switch_auto.active
                            pos_hint: {"x":.25,"y": 0.3}
                            id: lacture 
                            hint_text: "Number of Lacture"
                            helper_text: 'not required'
                            helper_text_mode: "on_focus"
                            mode: "round"
                            size_hint_x: 0.5
                            line_color_focus: 0.3, 0.6, 1,
                            icon_left: "book-open-page-variant" 
                            icon_left_color: 0.3, 0.6, 1, 1
                            hint_text_color: 0.3, 0.6, 1,1
                            hint_text: "Enter lacture name"
                            helper_text_color_focus: 0.3, 0.6, 1,1
                       
                        MDIconButton:
                            id: add_lacture_button
                            pos_hint: {"x":.75,"y":.3}
                            text: "ptess me"
                            icon: "plus"
                            disabled: not switch_auto.active
                            on_press:    
                                # root.time_manage(lacture.text)
                                app.root.get_screen('main').ids.main_screen_manager_home.get_screen('setting').time_manage(lacture.text)


                                               
        MDNavigationDrawer:
            id: nav_drawer

            MDNavigationDrawerMenu:
                MDNavigationDrawerHeader:
                    title: "Attendance App"
                    text: "ssccs@gmail.com"

                MDNavigationDrawerItem:
                    text: "Home"
                    icon: "home"
                    on_press:
                        nav_drawer.set_state("close")
                        main_screen_manager_home.current = "home"
                        #on_release: lambda *args: root.cap.release()
                       # app.root.ids.main_screen_manager_home.get_screen("main").ids.main_screen_manager_home.get_screen("start_attandance").ids.live_screen.re_camara()


                MDNavigationDrawerItem:
                    text: "Add Student"
                    icon: "plus"
                    on_press:
                        nav_drawer.set_state("close")
                        main_screen_manager_home.current = "add_student"
                MDNavigationDrawerItem:
                    text: "Start Attendance"
                    icon: "face-recognition"
                    on_press:
                        nav_drawer.set_state("close")
                        main_screen_manager_home.current = "start_attandance"   
                MDNavigationDrawerItem:

                    text: "Settings"
                    icon: "cog"
                    on_press:
                        nav_drawer.set_state("close")
                        main_screen_manager_home.current = "setting"             

<Graph>:
    MDTextField:
        mode: 'round'
        pos_hint: {"x":.05,"y":.8}
        size_hint: (.15,.08)
        id: one_student_roll
        hint_text: "Roll Number"
        helper_text: 'Must'
        helper_text_mode: "on_focus"
    MDTextField:
        size_hint: (.15,.08)
        mode: 'round'
        pos_hint: {"x":.30,"y":.8}
        id: one_student_date
        hint_text: "DD-MM-YYYY"
        helper_text: 'Date'
        helper_text_mode: "on_focus"    
    MDFlatButton:
        id :get_one
        pos_hint: {"center_x":.3,"y":.7}
        md_bg_color: (.1,.3,.2,1)
        theme_text_color: 'Custom'
        text_color: (.3,.4,.3) 
        text:"One Student Info"
        on_press: 
            root.get_one()
            print("of from kivy")
            # self.ids.one_student_roll.text=""
            # self.ids.one_student_date.text=""
    MDTextField:
        id:get_all_date
        size_hint: (.15,.08)
        mode: 'round'
        pos_hint: {"x":.6,"y":.8}
        # id: one_student
        hint_text: "DD-MM-YYYY"
        helper_text: 'Must'
        helper_text_mode: "on_focus"    
    MDFlatButton:
        id:get_all
        pos_hint: {"center_x":.75,"y":.7}
        md_bg_color: (.1,.3,.2,1)
        theme_text_color: 'Custom'
        text_color: (.3,.4,.3) 
        text:"All Student Info" 
        on_press: 
            root.get_all()
    Image:
        id:img_one
        size_hint: (.4,.4)
        pos_hint: {"center_x":.25,"center_y":.4}
        source:  ("test_one.png")

    Image:
        id:img_all
        size_hint: (.4,.4)
        pos_hint: {"center_x": .75,"center_y":.4}
        source:("test_all.png")

<Nav_graph_manager>:
    One_student:
        name: "one_student"
    All_student:
        name: "all_student"
    One_month:
        name: "one_month"
    Date_to_date:
        name: "date_to_date"  
           
           
<One_student>:
    
    MDFloatLayout:
        
        MDTextField:
            mode: 'round'
            pos_hint: {"center_x":.1,"y":.8}
            size_hint: (.15,.08)
            id: one_student_roll
            hint_text: "Roll Number"
            helper_text: 'Must'
            helper_text_mode: "on_focus"
        MDTextField:
            size_hint: (.15,.08)
            mode: 'round'
            pos_hint: {"center_x":.30,"y":.8}
            id: one_student_date
            hint_text: "DD-MM-YYYY"
            helper_text: 'Date'
            helper_text_mode: "on_focus"    
        AttractiveButton:
            id :get_onv
            pos_hint: {"center_x":.50,"y":.8}
            theme_text_color: 'Custom'
            text:"Get One Student"
            halign:"center"
            valign:"center"
            on_press: 
                root.get_one()
                # print("of from kivy")
                # self.ids.one_student_roll.text=""
                # self.ids.one_student_date.text=""
        
        Image:
            id:img_one
            size_hint: (.7,.7)
            pos_hint: {"center_x":.3,"center_y":.4}
            source:  ("test_one.png")
<All_student>:
    transform:"right"

    
    MDTextField:
        id:get_all_date
        size_hint: (.15,.08)
        mode: 'round'
        pos_hint: {"center_x":.1,"y":.8}
        # id: one_student
        hint_text: "DD-MM-YYYY"
        helper_text: 'Must'
        helper_text_mode: "on_focus"    
    AttractiveButton:
        id:get_all
        pos_hint: {"center_x":.50,"y":.8}
        halign:"center"
        text:"Get All Student" 
        on_press: 
            root.get_all()
    Image:
        id:img_all
        size_hint: (.6,.7)
        pos_hint: {"center_x":.3,"center_y":.4}
        source:("test_all.png")        
   
<One_month>:
    transform:"right"

    MDFloatLayout:
        
        MDTextField:
            id:get_all_month
            size_hint: (.2,.08)
            mode: 'round'
            pos_hint: {"center_x":.1,"y":.8}
            hint_text: "One Month Info"
            helper_text: 'Must'
            helper_text_mode: "on_focus"    
        AttractiveButton:
            id:get_month
            size_hint: (.15,.08)
            pos_hint: {"center_x":.5,"y":.8}
            halign:"center"
            text:"Get All Student" 
            on_press: 
                root.get_month()
        Image:
            id:img_all_month
            size_hint: (.6,.7)
            pos_hint: {"center_x":.3,"center_y":.4}
            source:("test_all_month.png")

<AttractiveButton@MDRectangleFlatIconButton+HoverBehavior>:
    font_size: "18sp"
    bold: True
    radius: [18, 18, 18, 18]
    theme_text_color: "Custom"
    text_color: 1, 1, 1, 1
    icon_color: 1, 1, 1, 1
    md_bg_color: 0.07, 0.45, 0.96, 1
    elevation: 10
    on_enter:
        self.md_bg_color = (0.15, 0.60, 1, 1)   # Brighter on hover
        self.elevation = 15
    on_leave:
        self.md_bg_color = (0.07, 0.45, 0.96, 1)
        self.elevation = 10

<Date_to_date>:
    transform:"right"
   
    MDFloatLayout:
        
        MDTextField:
            mode: 'round'
            pos_hint: {"center_x":.1,"y":.8}
            size_hint: (.15,.08)
            id:starting_date
            hint_text: "DD-MM-YYYY"
            helper_text: 'Starting Date'
            helper_text_mode: "on_focus"
        MDTextField:
            size_hint: (.15,.08)
            mode: 'round'
            pos_hint: {"center_x":.30,"y":.8}
            id: ending_date
            hint_text: "DD-MM-YYYY"
            helper_text: 'Ending Date'
            helper_text_mode: "on_focus"    
        AttractiveButton:
            id :date_date_button
            valign:"center"
            pos_hint: {"center_x":.50,"y":.8}

            text:"See Graph"
            on_press: 
                root.date_to_date()
                # print("of from kivy")
                # self.ids.one_student_roll.text=""
                # self.ids.one_student_date.text=""
        
        Image:
            id:date_to_date
            size_hint: (.7,.7)
            pos_hint: {"center_x":.3,"center_y":.4}
            source:  (r"D:\SmartAttendanceSystem\Kivy_app\date_to-date.png")         

<Navigation>: 
    id:navigation  
    size_hint: (.3,.75)
    pos_hint: {"x":.02,"y":0.1}        # orientation: 'vertical'
        
    canvas.before: 
        Color:
            rgba:(0.2,0.2,0.2,1)
        RoundedRectangle: 
            pos:self.pos
            size:self.size 
            radius:[20,20,20,20]
        Color:
            rgba: 0, 0, 0, 1  # border color (black)
        Line:
            width: 2  # border width
            rounded_rectangle: (*self.pos, *self.size, 20, 20, 20, 20)
    
    List_button:
        text: "One Student"
        icon: "account"
        pos_hint: {"x": .05, "y": .8}
        size_hint: (.85, .1)
        on_press:
            app.root.get_screen("main").ids.main_screen_manager_home.get_screen("home").ids.nav_graph_manager.get_screen_graph("one_student") 
    List_button:
        text: "All Student"
        icon: "account-group"
        pos_hint: {"x": .05, "y": .65}
        size_hint: (.85, .1)
        on_press:
            app.root.get_screen("main").ids.main_screen_manager_home.get_screen("home").ids.nav_graph_manager.get_screen_graph("all_student") 


    List_button:
        text: "One Month"
        icon: "calendar-month"
        pos_hint: {"x": .05, "y": .5}
        size_hint: (.85, .1)
        on_press:
            app.root.get_screen("main").ids.main_screen_manager_home.get_screen("home").ids.nav_graph_manager.get_screen_graph("one_month") 


    List_button:
        text: "Date to Date"
        icon: "calendar-range"
        pos_hint: {"x": .05, "y": .35}
        size_hint: (.85, .1)
        on_press:
            app.root.get_screen("main").ids.main_screen_manager_home.get_screen("home").ids.nav_graph_manager.get_screen_graph("date_to_date") 




    

            
